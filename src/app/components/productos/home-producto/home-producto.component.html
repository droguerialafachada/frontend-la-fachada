<div class="container">
  <div class="row">
    <div class="col-12">
      <h1 class="rojo">
        Gestion de Productos
      </h1>
    </div>
    <div class="col-8 col-sm-8 col-md-9 col-lg-10 col-xl-10 col-xxl-10">
      <div class="buscar">
        <input type="text" id="buscar" (keyup)="buscar($event)" placeholder="  Escanear o escribir c√≥digo">
      </div>
    </div>
    <div class="col-4 col-sm-4 col-md-3 col-lg-2 col-xl-2 col-xxl-2">
      <button id="nuevo" class="btn btn-primary" routerLink="/app/producto/nuevo">Nuevo</button>
    </div>
  </div>

  <h6 class="totalProductos">Se han encontrado {{ totalProductos }} productos.</h6>

  <div class="table-container">
    <div class="separador">
      <div class="table-responsive">
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>C√≥digo</th>
              <th>Nombre</th>
              <th class="d-none d-md-table-cell">FechaCreacion</th>
              <th class="eliminar">Acciones</th>
            </tr>
          </thead>


          <tbody>
            <!-- <tr *ngFor="let persona of personas"> -->
            <tr *ngFor="let producto of filtroProductos; let i=index">
              <td>{{ producto.codigo }}</td>
              <td>{{ producto.nombre }}</td>
              <td class="d-none d-md-table-cell">{{ producto.fechaCreacion | date }}</td>
              <td class="eliminar">
                <button class="editar" (click)="abrirModal(producto.codigo)">üëÅÔ∏è</button>
                <button class="editar red-x" (click)="eliminarProductoCodigo(producto.codigo)">x</button>
                <button class="editar" (click)="toggleModoEdicion(producto)">‚úèÔ∏è</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="pup-up" [ngClass]="{ 'oculto': modoOculto }">
      <div class="pop-up-container">
        <span class="cerrar" (click)="editarModoOcuto()">‚ùå</span>
        <app-editar-producto class="editar" [productosEditar]="productosEditar"
          (modoOculto)="editarModoOcuto()"></app-editar-producto>

      </div>
    </div>

  </div>
  <div class="modal" [ngClass]="{ show: modalAbierto }" (click)="cerrarModal()">
    <div class="modal-dialog modal-xl" (click)="$event.stopPropagation()">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Detalles del Producto</h5>
          <button type="button" class="btn-close" (click)="cerrarModal()"></button>
        </div>
        @if(productoSeleccionado){
          <div class="modal-body">
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="codigo" class="form-label">C√≥digo</label>
                <input type="text" id="codigo" class="form-control" [(ngModel)]="productoSeleccionado.codigo" readonly />
              </div>
              <div class="col-md-6">
                <label for="nombre" class="form-label">Nombre</label>
                <input type="text" id="nombre" class="form-control" [(ngModel)]="productoSeleccionado.nombre" readonly />
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="activo" class="form-label">Activo</label>
                <input type="text" id="activo" class="form-control" [(ngModel)]="productoSeleccionado.activo" readonly />
              </div>
              <div class="col-md-6">
                <label for="fechaCreacion" class="form-label">Fecha de Creaci√≥n</label>
                <input type="text" id="fechaCreacion" class="form-control" [(ngModel)]="productoSeleccionado.fechaCreacion" readonly />
              </div>
            </div>
            <h6 class="mt-4">Formas de Venta</h6>
            <div *ngIf="productoSeleccionado?.formaVentas; else sinDatos">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Precio de compra</th>
                    <th>Precio de venta</th>
                    <th>Cantidad</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let forma of productoSeleccionado?.formaVentas">
                    <td>
                      <input type="text" class="form-control" [(ngModel)]="forma.nombre" readonly />
                    </td>
                    <td>
                      <input type="text" class="form-control" [(ngModel)]="forma.precioCompra" readonly />
                    </td>
                    <td>
                      <input type="text" class="form-control" [(ngModel)]="forma.precioVenta" readonly />
                    </td>
                    <td>
                      <input type="text" class="form-control" [(ngModel)]="forma.cantidad" readonly />
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <ng-template #sinDatos>
              <p class="text-muted">No hay formas de venta disponibles.</p>
            </ng-template>
          </div>
        }
      </div>
    </div>
  </div>
  

  <div class="d-flex justify-content-center align-items-center mt-3 flex-wrap" *ngIf="modoOculto">
    <nav aria-label="Page navigation" class="w-100">
      <ul class="pagination justify-content-center mt-3 flex-wrap">
        <!-- P√°gina anterior -->
        <li class="page-item" [class.disabled]="paginaActual === 0">
          <button class="page-link" (click)="paginaAnterior()" tabindex="-1" aria-disabled="true">
            Anterior
          </button>
        </li>
  
        <!-- Mostrar las p√°ginas -->
        <li class="page-item" *ngFor="let page of paginas; let i = index" [class.active]="paginaActual === i">
          <button class="page-link" (click)="irPagina(i)">{{ i + 1 }}</button>
        </li>
  
        <!-- P√°gina siguiente -->
        <li class="page-item" [class.disabled]="paginaActual === totalPaginas - 1">
          <button class="page-link" (click)="paginaSiguiente()">Siguiente</button>
        </li>
      </ul>
    </nav>
  </div>

